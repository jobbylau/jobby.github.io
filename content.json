[{"title":"Yii 2.0 框架初学之实现注册功能(转)","date":"2017-03-08T13:57:10.000Z","path":"2017/03/08/laravel-stuff/","text":"初学YII框架，与大家分享一下。 首先得配置好数据库，比较简单，这里就不细说了。这里主要说YII框架代码实现。 在controller/siteController.php控制器里设置注册方法 /** * @return string|\\yii\\web\\Response * 设置注册方法 */ public function actionSignup() { { $model = new SignupForm(); if ($model-&gt;load(Yii::$app-&gt;request-&gt;post())) //载入post所获取的数据 { if ($user=$model-&gt;signup()) { if(Yii::$app-&gt;getUser()-&gt;login($user)) { return $this-&gt;goHome(); } } } return $this-&gt;render(&apos;signup&apos;, [ &apos;model&apos; =&gt; $model, ]); //显示注册页面 } } 在models/signupForm.php 的模型类文件 namespace home\\models; use yii\\base\\Model; class SignupForm extends Model { public $username; public $password; public $email; public function rules() { return [ [[&apos;username&apos;,&apos;password&apos;,&apos;email&apos;],&apos;required&apos;], [&apos;email&apos;,&apos;email&apos;], [&apos;username&apos;,&apos;filter&apos;,&apos;filter&apos;=&gt;&apos;trim&apos;],//过滤输入的空格 [&apos;username&apos;,&apos;string&apos;,&apos;min&apos;=&gt;2,&apos;max&apos;=&gt;8],//限制输入字符的长度 [&apos;username&apos;,&apos;unique&apos;,&apos;targetClass&apos;=&gt;&apos;home\\models\\User&apos;,&apos;message&apos;=&gt;&apos;用户名已存在&apos;],//判断用户名是否已被注册 [&apos;email&apos;,&apos;unique&apos;,&apos;targetClass&apos;=&gt;&apos;home\\models\\User&apos;,&apos;message&apos;=&gt;&apos;邮箱已被注册&apos;],//判断邮箱是否已被注册 ]; } public function attributeLabels() //设置字段标签名 { return [ &apos;username&apos;=&gt;&apos;用户名&apos;, &apos;password&apos;=&gt;&apos;密码&apos;, &apos;email&apos;=&gt;&apos;邮箱&apos;, ]; } public function signup() { if(!$this-&gt;validate()) //validate方法即执行rules方法里的设置 { return null; } $user=new User(); $user-&gt;username=$this-&gt;username; $user-&gt;setPassword($this-&gt;password);//存储并加密密码的方法，在User模型类里 $user-&gt;email=$this-&gt;email; $user-&gt;setAuthKey(); //插入数据库 return $user-&gt;save() ? $user : null; } } 在view文件夹下新建注册页面的视图文件注册页面的视图文件可用Gii来生成 use yii\\helpers\\Html; use yii\\widgets\\ActiveForm; ?&gt; field($model, &apos;username&apos;)-&gt;textInput([&apos;autofocus&apos;=&gt;true,&apos;placeholder&apos;=&gt;&apos;请输入用户名&apos;]); ?&gt; field($model, &apos;password&apos;)-&gt;passwordInput([&apos;placeholder&apos;=&gt;&apos;请输入密码&apos;]);; ?&gt; field($model, &apos;email&apos;) ?&gt; &apos;btn btn-primary&apos;]) ?&gt; User模型类里书写以下代码 namespace home\\models; use yii\\db\\ActiveRecord; use yii\\web\\IdentityInterface; /** * @param $password * 存储并加密密码 */ public function setPassword($password) { $this-&gt;password_hash=\\Yii::$app-&gt;security-&gt;generatePasswordHash($password); } /** *产生authkey */ public function setAuthKey() { $this-&gt;auth_key=\\Yii::$app-&gt;security-&gt;generateRandomString(); } 包含的知识点 模型载入用户所提交的数据 $model-&gt;load(\\Yii:$app-&gt;request-&gt;post()) 延伸学习 //处理请求 $request=Yii::$app-&gt;request; $get=$request-&gt;get();//获取get的值，等价于$get=$_GET; $id=$request-&gt;get(&apos;id&apos;);// 等价于$id = isset($_GET[&apos;id&apos;]) ? $_GET[&apos;id&apos;] : null; $id=$request-&gt;get(&apos;id&apos;,&apos;1&apos;);//等价于$id=isset($_GET[&apos;id&apos;]) ? $_GET[&apos;id&apos;] : 1; $post=Yii::$app-&gt;request-&gt;post(); $post=Yii::$app-&gt;request-&gt;post(&apos;name&apos;,&apos;&apos;);// $id=isset($_POST[&apos;name&apos;]) ? $_POST[&apos;name&apos;] : &apos;&apos;; //判断请求方法 if(Yii::$app-&gt;request-&gt;isPost){}; if(Yii::$app-&gt;request-&gt;isAjax){}; if(Yii::$app-&gt;request-&gt;isGet){}; if(Yii::$app-&gt;request-&gt;isPut){}; //更多参考见官方文档 登录用户 Yii::$app-&gt;getUser()-&gt;login($user) 表单输入验证的规则设置 public function rules() { return [ [[&apos;username&apos;,&apos;password&apos;,&apos;email&apos;],&apos;required&apos;], [&apos;email&apos;,&apos;email&apos;], [&apos;username&apos;,&apos;filter&apos;,&apos;filter&apos;=&gt;&apos;trim&apos;],//过滤输入的空格 [&apos;username&apos;,&apos;string&apos;,&apos;min&apos;=&gt;2,&apos;max&apos;=&gt;8],//限制输入字符的长度 [&apos;username&apos;,&apos;unique&apos;,&apos;targetClass&apos;=&gt;&apos;home\\models\\User&apos;,&apos;message&apos;=&gt;&apos;用户名已存在&apos;],//判断用户名是否已被注册 [&apos;email&apos;,&apos;unique&apos;,&apos;targetClass&apos;=&gt;&apos;home\\models\\User&apos;,&apos;message&apos;=&gt;&apos;邮箱已被注册&apos;],//判断邮箱是否已被注册 ]; } //搭配以下代码使用 if ($model-&gt;validate()) { // all inputs are valid } else { // validation failed: $errors is an array containing error messages $errors = $model-&gt;errors; } //更多详情参考官方手册 //http://www.yiichina.com/doc/guide/2.0/input-validation创建表单视图 use yii\\helpers\\Html; use yii\\widgets\\ActiveForm; ?&gt; field($model, &apos;username&apos;)-&gt;textInput([&apos;autofocus&apos;=&gt;true,&apos;placeholder&apos;=&gt;&apos;请输入用户名&apos;]); ?&gt; field($model, &apos;password&apos;)-&gt;passwordInput([&apos;placeholder&apos;=&gt;&apos;请输入密码&apos;]);; ?&gt; field($model, &apos;email&apos;) ?&gt; &apos;btn btn-primary&apos;]) ?&gt; //更多详情参考官方手册 //http://www.yiichina.com/doc/api/2.0/yii-widgets-activeform将数据保存到数据库 $user-&gt;username=$this-&gt;username; $user-&gt;email=$this-&gt;email; $user-&gt;save();","tags":[{"name":"YII","slug":"YII","permalink":"https://jobbylau.github.io/tags/YII/"}]},{"title":"One day in Macau","date":"2017-03-06T15:42:32.000Z","path":"2017/03/06/One day in Macau/","text":"昨天有幸体验了一把资本主义社会的奢华和腐败。所幸在资本主义的奢华与腐败面前，仍然能高举社会主义的旗帜，背负着赢够“资本主义”的钱，光荣回到社会主义体制下消费。然而不尽人意，还是在强大的资本主义的势力下，向资本低头。 民政总署 大三巴威尼斯酒店威尼斯大门走廊威尼斯运河金沙酒店外面的铁塔","tags":[{"name":"澳门","slug":"澳门","permalink":"https://jobbylau.github.io/tags/澳门/"}]},{"title":"Have a nice weekend","date":"2017-03-04T14:38:44.000Z","path":"2017/03/04/Have-a-nice-weekend/","text":"又来到了熟悉的城市-珠海。还是老样子去拱北口岸和文华书店逛了一圈。今天太累了，就先写到这了。 ​ 邓小平题字 ​ 拱北口岸","tags":[{"name":"珠海","slug":"珠海","permalink":"https://jobbylau.github.io/tags/珠海/"}]}]